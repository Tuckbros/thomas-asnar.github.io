<link rel="import" href="polymer-element.df8b0c9d.html"><link rel="import" href="mixin.708baecf.html"><link rel="import" href="array-splice.fccf4c7c.html"><script>!function(){"use strict";let e=Polymer.dedupingMixin(e=>{return class extends e{static get properties(){return{items:{type:Array},multi:{type:Boolean,value:!1},selected:{type:Object,notify:!0},selectedItem:{type:Object,notify:!0},toggle:{type:Boolean,value:!1}}}static get observers(){return["__updateSelection(multi, items.*)"]}constructor(){super(),this.__lastItems=null,this.__lastMulti=null,this.__selectedMap=null}__updateSelection(e,t){let s=t.path;if("items"==s){let s=t.base||[],l=this.__lastItems;if(e!==this.__lastMulti&&this.clearSelection(),l){let e=Polymer.ArraySplice.calculateSplices(s,l);this.__applySplices(e)}this.__lastItems=s,this.__lastMulti=e}else if("items.splices"==t.path)this.__applySplices(t.value.indexSplices);else{let e=s.slice("items.".length),t=parseInt(e,10);e.indexOf(".")<0&&e==t&&this.__deselectChangedIdx(t)}}__applySplices(e){let t=this.__selectedMap;for(let s=0;s<e.length;s++){let l=e[s];t.forEach((e,s)=>{e<l.index||(e>=l.index+l.removed.length?t.set(s,e+l.addedCount-l.removed.length):t.set(s,-1))});for(let e=0;e<l.addedCount;e++){let s=l.index+e;t.has(this.items[s])&&t.set(this.items[s],s)}}this.__updateLinks();let s=0;t.forEach((e,l)=>{e<0?(this.multi?this.splice("selected",s,1):this.selected=this.selectedItem=null,t.delete(l)):s++})}__updateLinks(){if(this.__dataLinkedPaths={},this.multi){let e=0;this.__selectedMap.forEach(t=>{t>=0&&this.linkPaths("items."+t,"selected."+e++)})}else this.__selectedMap.forEach(e=>{this.linkPaths("selected","items."+e),this.linkPaths("selectedItem","items."+e)})}clearSelection(){this.__dataLinkedPaths={},this.__selectedMap=new Map,this.selected=this.multi?[]:null,this.selectedItem=null}isSelected(e){return this.__selectedMap.has(e)}isIndexSelected(e){return this.isSelected(this.items[e])}__deselectChangedIdx(e){let t=this.__selectedIndexForItemIndex(e);if(t>=0){let e=0;this.__selectedMap.forEach((s,l)=>{t==e++&&this.deselect(l)})}}__selectedIndexForItemIndex(e){let t=this.__dataLinkedPaths["items."+e];if(t)return parseInt(t.slice("selected.".length),10)}deselect(e){let t=this.__selectedMap.get(e);if(t>=0){let s;this.__selectedMap.delete(e),this.multi&&(s=this.__selectedIndexForItemIndex(t)),this.__updateLinks(),this.multi?this.splice("selected",s,1):this.selected=this.selectedItem=null}}deselectIndex(e){this.deselect(this.items[e])}select(e){this.selectIndex(this.items.indexOf(e))}selectIndex(e){let t=this.items[e];this.isSelected(t)?this.toggle&&this.deselectIndex(e):(this.multi||this.__selectedMap.clear(),this.__selectedMap.set(t,e),this.__updateLinks(),this.multi?this.push("selected",t):this.selected=this.selectedItem=t)}}});Polymer.ArraySelectorMixin=e;let t=e(Polymer.Element);class s extends t{static get is(){return"array-selector"}}customElements.define(s.is,s),Polymer.ArraySelector=s}();</script>