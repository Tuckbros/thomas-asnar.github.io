<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="moment.html">

</head><body><dom-module id="ta-clock">
  <template>
    <style>
      :host {
        display: inline-block;
      }
      :host .clock{
        font-weight: bolder;
        color: #616161;
        text-shadow: #e0e0e0 1px 1px 0;
        padding: 20px;
        border-radius: 50px;
        border: 2px solid #e0e0e0 ;
        text-align: center;
        font-size:2em;
      }
      :host .clock-title{
        text-align: center;
        font-size:1.3em;
        font-weight: bolder;
      }
      :host .clock-subtitle{
        text-align: center;
        font-size:1em;
        font-weight: 400;
      }
      :host .hidden{
        visibility: hidden;
        display:none;
      }
    </style>
    <div class$="[[ clockTitleisHidden ]] clock-title">[[ clockTitle ]]</div>
    <div class$="[[ clockSubTitleisHidden ]] clock-subtitle">[[ clockSubTitle ]]</div>
    <div class="clock">[[ clockValue ]]</div>
  </template>
  
  <script>
    /**
     * `ta-clock`
     * simple clock element
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class TaClock extends Polymer.Element {
      static get is() { return 'ta-clock'; }
      static get properties() {
        return {
          clockType: String,
          clockTitle: String,
          clockTitleisHidden: String,
          clockSubTitle: String,
          clockSubTitleisHidden: String,
          clockFormat: {
            type: String,
            value: "LTS"
          },
          clockValue: {
            type: String,
            value: "--:--",
            observer: '_onChangeClockValue'
          }
        };
      }

      constructor() {
        super();
      }
      
      connectedCallback() {
        super.connectedCallback();
        var self = this

        if(self.clockType == "now") {
          self.clockValue = moment().format(self.clockFormat)
          setInterval(function(){ 
            self.clockValue = moment().format(self.clockFormat)
          }, 1000);
        }

        if(self.clockTitle === undefined){
            self.clockTitleisHidden = "hidden"
        }
        if(self.clockSubTitle === undefined){
            self.clockSubTitleisHidden = "hidden"
        }
      }

      _onChangeClockValue(newValue, oldValue){
        if(this.clockType != "now"){
          if(Number.isInteger(newValue)){
            if(this.clockType.includes("duration")){
              let signe
              newValue < 0 ? signe = "-" : signe = "+"
              this.clockValue = signe + " " + 
                                Math.abs(moment.duration(newValue).hours()) +
                                "h" + Math.abs(moment.duration(newValue).minutes())
            }else{
              this.clockFormat = "kk:mm"
              this.clockValue = moment(newValue).format(this.clockFormat)
            }
          }
        }
      } // end _onChangeClockValue
    }

    customElements.define(TaClock.is, TaClock);
  </script>
</dom-module>
</body></html>